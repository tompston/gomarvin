{{ $go_version      := .ProjectInfo.GoVersion -}}
{{ $project_name    := .ProjectInfo.Name -}}
{{ $api_v 		    := ApiVersion .ProjectInfo.APIPrefix -}}
// Server generated by gomarvin, {{ ConvertLastCharTo .ProjectInfo.GomarvinVersion "x" }}
// Repo : https://github.com/tompston/gomarvin
// Docs : https://gomarvin.pages.dev/docs

package main

import (
	"context"
	"{{$project_name}}/internal/api/{{ $api_v }}/server"
	"{{$project_name}}/pkg/environment"
	"{{$project_name}}/pkg/settings"
	"fmt"
	"log"

	{{- if ( eq .ProjectInfo.Framework "chi") }}
	"net/http"
	{{ end }}
)


func main() {
	app, err := environment.NewApp(context.TODO())
	if err != nil {
		log.Fatal(err)
	}
	defer app.Exit(context.TODO())


	address := fmt.Sprintf("localhost:%v", settings.Environment.Backend.Port)
	app := server.Start()

	{{- if ( eq .ProjectInfo.Framework "gin") }}
	app.Run(address) // run the server
	{{- end }}

	{{- if ( eq .ProjectInfo.Framework "fiber") }}
	app.Listen(address) // run the server
	{{- end }}

	{{- if ( eq .ProjectInfo.Framework "echo") }}
	app.Logger.Fatal(app.Start(address)) // run the server
	{{- end }}

	{{- if ( eq .ProjectInfo.Framework "chi") }}
	http.ListenAndServe(address, app) // run the server
	{{- end }}
}